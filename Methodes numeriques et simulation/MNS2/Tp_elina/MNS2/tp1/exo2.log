-- FreeFem++ v4.6 (Fri, Apr 03, 2020  2:08:08 PM - git v4.6)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : // Parameters
    2 : real cpu=clock();
    3 : int C1=99;
    4 :
    5 :
    6 : // Mesh
    7 :
    8 :
    9 :
   10 : border C11(t=0., 1.){x=0.; y=1-t; label=C1;}
   11 : border C12(t=0., 1.){x=1-t; y=1.; label=C1;}
   12 : border C13(t=0., 1.){x=1.; y=t; label=C1;}
   13 : border C14(t=0., 1.){x=t; y=0.; label=C1;}
   14 : border C0(t=0., 2.*pi){x=0.3*cos(-t)+0.5; y=0.3*sin(-t)+0.5;}
   15 :
   16 : plot( C0(50)+ C11(10)+C12(10)+C13(10)+C14(10),wait=true, ps="heatexb.eps");
   17 :
   18 : mesh Th=buildmesh(C0(50)+ C11(10)+C12(10)+C13(10)+C14(10));
   19 :
   20 : plot(Th,wait=1);
   21 :
   22 :
   23 : //Fonction de x et y
   24 : func f =1;
   25 :
   26 : // Definition de l'espace des elements finis P1 associe au maillage Th
   27 : fespace Vh(Th, P2);
   28 : cout << "temps CPU apres def du maillage = " << (clock()-cpu) << endl;
   29 :
   30 : //uh et ch sont des elements de Vh
   31 : Vh uh, vh;
   32 :
   33 : // Definition du pb variationnel
   34 : problem laplacien(uh, vh, solver = LU)=int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh))-int2d(Th)(f*vh)+ on(C1,uh=1) + on(5,uh=0);
   35 : cout << "temps CPU apres def du pb var = " << (clock()-cpu) <<endl;
   36 :
   37 : //Resolution du pb
   38 : laplacien;
   39 : cout << "temps CPU apres resolution = " <<(clock()-cpu) << endl;
   40 :
   41 : //Calcul erreur
   42 : func u = x*(1.0-x)*y*(1.0-y);
   43 : Vh error = u-uh;
   44 :
   45 : real errL2 = sqrt(int2d(Th)(error^2));
   46 : real errH1 = sqrt(int2d(Th)(error^2+dx(error)^2+dy(error)^2));
   47 : cout << "erreur L2"<< errL2 << endl;
   48 : cout << "erreur H1"<< errH1 << endl;
   49 :
   50 : //On visualise le maillage et le resultat
   51 : plot(Th, wait = true, ps="mesh.eps");
   52 : plot(uh, wait = true); sizestack + 1024 =2672  ( 1648 )
 
  --  mesh:  Nb of Triangles =    360, Nb of Vertices 225
temps CPU apres def du maillage = 0.164
temps CPU apres def du pb var = 0.165
  SkyLineMatrix: size pL/pU: 810 18465 18465 moy=22.7963
  -- Solve :
          min 7.25277e-32  max 1
temps CPU apres resolution = 0.171
erreur L20.579547
erreur H13.45361
times: compile 0.069s, execution 7.748s,  mpirank:0
 ######## We forget of deleting   -3 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3731,  size :482544 mpirank: 0
Ok: Normal End
 try getConsole P:\4A\MNS2\tp1\exo2.edp
